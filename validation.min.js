define(function(t,i,a){"use strict";t("lib/jquery.form");var e=function(t){var i={formId:"#form",validDom:".form-group",validSuccess:function(t,i){$(t).parents(e).removeClass("error").find(".err-msg").text("")},validError:function(t,i){var i=$(t).data("msg")||i;$(t).parents(e).addClass("error").find(".err-msg").text(i)},ajaxSuccess:function(t){}},a=$.extend({},i,t),e=a.validDom,s=$(a.formId),n=a.validSuccess,r=a.validError,d=a.ajaxSuccess,o=a.beforeSubmit,l=a.reload||0,u=s.find("button[type='submit']"),c=s.find("button[type='submit']").html();s.find(".err-tip-content").length<1&&s.find(e).each(function(){var t=$(this).width()+7;$(this).append('<div class="err-tip-content" style="left:'+t+'px"><div class="err-box"><div class="tri-right"></div><div class="err-msg"></div></div></div>')}),$.validate={validator:function(t,i){var a={noEmpty:{isValid:function(t){return""==t?!1:!0},message:"不能为空"},email:{isValid:function(t){return/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/i.test(t)},message:"请输入有效的邮箱地址"},number:{isValid:function(t){return/^[0-9]+(.[0-9])?$/.test(t)},message:"请输入数字"},account:{isValid:function(t){return/^[a-zA-Z][a-zA-Z0-9_]{4,10}$/.test(t)},message:"请输入5~10位，账号需字母开头"},same:{isValid:function(t){var i=$(".J_old").val();return t==i?!0:!1},message:"两次密码不一致"},mobile:{isValid:function(t){return/^\d{11}$/.test(t)},message:"请输入有效的手机号码"},idCard:{isValid:function(t){return/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/.test(t)},message:"请输入有效的身份证号码"}};return{isValid:a[t].isValid(i),message:a[t].message}},handle:function(t,i){var a=this.validator,e=s.find(i);e.addClass("validate"),e.on("focus change",function(i){var e=$(this).val(),s=a(t,e).message;a(t,e).isValid?n($(this)):r($(this),s)})},onSubmit:function(){s.ajaxForm({beforeSubmit:function(){var t=!0;if(s.find(".validate").each(function(){return""==$(this).val()||$(this).parents(e).hasClass("error")?($(this).focus(),t=!1,!1):void 0}),!t)return!1;if(o&&0==o())return!1;var i=s.find("button[type='submit']"),a=i.data("msg")||"保存中...";i.attr("disabled","disabled").html(a),setTimeout(function(){i.removeAttr("disabled","disabled").html(c)},8e3)},success:function(t){d(t),u.removeAttr("disabled","disabled").html(c)},dataType:"json"})}},s.find("[data-validtype]").each(function(){var t=$(this).data("validtype");$.validate.handle(""+t,$(this))}),$.validate.onSubmit()};a.exports=e});